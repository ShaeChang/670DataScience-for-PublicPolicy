"0","set.seed(20200302)"
"0","# input the data"
"0","rats <- tribble(~rat_burrow, ~pizza_proximity,"
"0","  1, 0.01,"
"0","  1, 0.05,"
"0","  1, 0.08,"
"0","  0, 0.1,"
"0","  0, 0.12,"
"0","  1, 0.2,"
"0","  1, 0.3,"
"0","  1, 0.5,"
"0","  1, 0.75,"
"0","  0, 0.9,"
"0","  1, 1,"
"0","  0, 1.2,"
"0","  0, 2.2,"
"0","  0, 2.3,"
"0","  0, 2.5,"
"0","  1, 3,"
"0","  0, 3.5,"
"0","  0, 4,"
"0","  0, 5,"
"0","  0, 7"
"0",") %>%"
"0"," mutate(rat_burrow = factor(rat_burrow))"
"0",""
"0","# split into training and testing data"
"0","split <- initial_split(rats, prop = 0.75)"
"0","rats_training <- training(split)"
"0","rats_testing <- testing(split)"
"0","rats_k1 <- vfold_cv(data = rats_training,"
"0","                    v = 3)"
"0","rats_k3 <- vfold_cv(data = rats_training,"
"0","                    v = 3)"
"0","rats_kn <- vfold_cv(data = rats_training,"
"0","                    v = 3)"
"0","#Extract the analysis data and assessment data from the first resample in rats_k1, rats_k3, and rats_kn."
"0","analysis_k1 <- rats_k1$splits[[1]] %>% analysis()"
"0","assess_k1 <- rats_k1$splits[[1]] %>% assessment()"
"0","analysis_k3 <- rats_k3$splits[[1]] %>% analysis()"
"0","assess_k3 <- rats_k3$splits[[1]] %>% assessment()"
"0","analysis_kn <- rats_kn$splits[[1]] %>% analysis()"
"0","assess_kn <- rats_kn$splits[[1]] %>% assessment()"
"0","#calculate y_hat for each assessment data"
"0","#for k = 1"
"0","# (1) create a knn model specification"
"0","knn_mod_k1 <-"
"0","  nearest_neighbor(neighbors = 1) %>%"
"0","  set_engine(engine = ""kknn"") %>%"
"0","  set_mode(mode = ""classification"")"
"0","# (2) fit the knn model specification on the training data"
"0","knn_fit_k1 <- knn_mod_k1 %>%"
"0","  fit(formula = rat_burrow ~ pizza_proximity, data = analysis_k1)"
"0","# (3) use the estimated model to predict values in the testing data"
"0","prediction_k1 <-"
"0","  bind_cols(assess_k1,"
"0","    predict(object = knn_fit_k1, new_data = assess_k1)"
"0","  )"
"0","#for k = 3"
"0","# (1) create a knn model specification"
"0","knn_mod_k3 <-"
"0","  nearest_neighbor(neighbors = 3) %>%"
"0","  set_engine(engine = ""kknn"") %>%"
"0","  set_mode(mode = ""classification"")"
"0","# (2) fit the knn model specification on the training data"
"0","knn_fit_k3 <- knn_mod_k3 %>%"
"0","  fit(formula =  rat_burrow ~ pizza_proximity, data = analysis_k3)"
"0","# (3) use the estimated model to predict values in the testing data"
"0","prediction_k3 <-"
"0","  bind_cols(assess_k3,"
"0","    predict(object = knn_fit_k3, new_data = assess_k3)"
"0","  )"
"0","#for k = n, let n = 5 because we have 5 observations in total in our assessment data set"
"0","# (1) create a knn model specification"
"0","knn_mod_kn <-"
"0","  nearest_neighbor(neighbors = 5) %>%"
"0","  set_engine(engine = ""kknn"") %>%"
"0","  set_mode(mode = ""classification"")"
"0","# (2) fit the knn model specification on the training data"
"0","knn_fit_kn <- knn_mod_kn %>%"
"0","  fit(formula = rat_burrow ~ pizza_proximity, data = analysis_kn)"
"0","# (3) use the estimated model to predict values in the testing data"
"0","prediction_kn <-"
"0","  bind_cols(assess_kn,"
"0","    predict(object = knn_fit_kn, new_data = assess_kn)"
"0","  )"
"0","# Include the data frame in your R Markdown document"
"0","knitr::kable(prediction_k1)"
